<!DOCTYPE html>
<html lang="fi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uusi Tapahtuma</title>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>
    <div class="container">
        <h1>Uusi tapahtuma</h1>
        <form id="createEventForm">
            <label for="eventTime">Aika:</label>
            <input type="datetime-local" id="eventTime" name="eventTime" required><br><br>

            <label for="venueName">Paikka:</label>
            <input type="text" id="venueName" name="venueName" required><br><br>

            <label for="eventDescription">Kuvaus:</label>
            <input type="text" id="eventDescription" name="eventDescription" required><br><br>

            <label for="cityName">Kaupunki:</label>
            <input type="text" id="cityName" name="cityName" required><br><br>

            <label for="ticketsQuantity">Lippuja kpl:</label>
            <input type="number" id="ticketsQuantity" name="ticketsQuantity" min="1" required><br><br>

            <button type="submit">Tallenna</button>
        </form>
    </div>

    <script>
        document.getElementById('createEventForm').addEventListener('submit', async (event) => {
            event.preventDefault();

            // Collect form data
            const eventTime = document.getElementById('eventTime').value;
            const venueName = document.getElementById('venueName').value;
            const eventDescription = document.getElementById('eventDescription').value;
            const cityName = document.getElementById('cityName').value;
            const ticketsQuantity = document.getElementById('ticketsQuantity').value;

            try {
                const response = await fetch('/api/events', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        startTime: eventTime,
                        venueName: venueName,
                        description: eventDescription,
                        city: cityName,
                        ticketsAvailable: ticketsQuantity
                    })
                });

                if (response.ok) {
                    alert('Tapahtuma tallennettu!');
                    window.location.href = '/'; // Redirect back to the main page
                } else {
                    alert('Tapahtuman tallennus ep√§onnistui.');
                }
            } catch (error) {
                console.error('Virhe tapahtuman luonnissa:', error);
            }
        });
    </script>
</body>

</html>
